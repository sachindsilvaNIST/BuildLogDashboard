<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="using:BuildLogDashboard.ViewModels"
        xmlns:m="using:BuildLogDashboard.Models"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d" d:DesignWidth="1400" d:DesignHeight="900"
        x:Class="BuildLogDashboard.Views.MainWindow"
        x:DataType="vm:MainWindowViewModel"
        Title="Android OS Image Build Log Dashboard"
        Width="1400" Height="900"
        MinWidth="1000" MinHeight="600"
        Background="{StaticResource GlassBackgroundBrush}">

    <Design.DataContext>
        <vm:MainWindowViewModel/>
    </Design.DataContext>

    <Grid RowDefinitions="Auto,*,Auto">

        <!-- Toolbar -->
        <Border Grid.Row="0"
                Background="{StaticResource GlassPanelTranslucentBrush}"
                BorderBrush="{StaticResource GlassBorderBrush}"
                BorderThickness="0,0,0,1"
                Padding="12,8">
            <Grid ColumnDefinitions="Auto,Auto,*,Auto">
                <!-- Left toolbar buttons -->
                <StackPanel Grid.Column="0" Orientation="Horizontal" Spacing="8">
                    <Button Command="{Binding OpenFolderCommand}"
                            ToolTip.Tip="Open Workspace Folder"
                            Padding="12,8"
                            Background="Transparent">
                        <StackPanel Orientation="Horizontal" Spacing="6">
                            <PathIcon Data="M2 6C2 4.89543 2.89543 4 4 4H9L11 6H20C21.1046 6 22 6.89543 22 8V18C22 19.1046 21.1046 20 20 20H4C2.89543 20 2 19.1046 2 18V6Z"
                                      Width="16" Height="16"/>
                            <TextBlock Text="Open Folder" VerticalAlignment="Center"/>
                        </StackPanel>
                    </Button>

                    <Button Command="{Binding NewBuildCommand}"
                            ToolTip.Tip="Create New Build Log"
                            Padding="12,8"
                            Background="Transparent">
                        <StackPanel Orientation="Horizontal" Spacing="6">
                            <PathIcon Data="M12 4V20M4 12H20" Width="16" Height="16"/>
                            <TextBlock Text="New Build" VerticalAlignment="Center"/>
                        </StackPanel>
                    </Button>

                    <Button Command="{Binding SaveBuildCommand}"
                            ToolTip.Tip="Save Current Build"
                            Padding="12,8"
                            Background="Transparent">
                        <StackPanel Orientation="Horizontal" Spacing="6">
                            <PathIcon Data="M17 3H5C3.89 3 3 3.9 3 5V19C3 20.1 3.89 21 5 21H19C20.1 21 21 20.1 21 19V7L17 3ZM19 19H5V5H16.17L19 7.83V19ZM12 12C10.34 12 9 13.34 9 15S10.34 18 12 18 15 16.66 15 15 13.66 12 12 12ZM6 6H15V10H6V6Z"
                                      Width="16" Height="16"/>
                            <TextBlock Text="Save" VerticalAlignment="Center"/>
                        </StackPanel>
                    </Button>

                    <Rectangle Width="1" Fill="{StaticResource GlassBorderBrush}" Margin="8,4"/>

                    <Button Command="{Binding ImportMarkdownCommand}"
                            ToolTip.Tip="Import Markdown File"
                            Padding="12,8"
                            Background="Transparent">
                        <StackPanel Orientation="Horizontal" Spacing="6">
                            <PathIcon Data="M5 20H19V18H5V20ZM19 9H15V3H9V9H5L12 16L19 9Z" Width="16" Height="16"/>
                            <TextBlock Text="Import" VerticalAlignment="Center"/>
                        </StackPanel>
                    </Button>

                    <Button Command="{Binding ExportMarkdownCommand}"
                            ToolTip.Tip="Export as Markdown"
                            Padding="12,8"
                            Background="Transparent">
                        <StackPanel Orientation="Horizontal" Spacing="6">
                            <PathIcon Data="M9 16H15V10H19L12 3L5 10H9V16ZM5 18H19V20H5V18Z" Width="16" Height="16"/>
                            <TextBlock Text="Export" VerticalAlignment="Center"/>
                        </StackPanel>
                    </Button>
                </StackPanel>

                <!-- Workspace path -->
                <Border Grid.Column="1"
                        Background="{StaticResource GlassPanelBrush}"
                        BorderBrush="{StaticResource GlassBorderBrush}"
                        BorderThickness="1"
                        CornerRadius="4"
                        Padding="8,4"
                        Margin="16,0,0,0"
                        IsVisible="{Binding WorkspacePath, Converter={x:Static StringConverters.IsNotNullOrEmpty}}">
                    <TextBlock Text="{Binding WorkspacePath}"
                               Foreground="{StaticResource GlassSubtleTextBrush}"
                               FontSize="12"
                               MaxWidth="300"
                               TextTrimming="CharacterEllipsis"/>
                </Border>

                <!-- Right toolbar buttons -->
                <StackPanel Grid.Column="3" Orientation="Horizontal" Spacing="8">
                    <Button Command="{Binding TogglePreviewCommand}"
                            ToolTip.Tip="Toggle Preview Panel"
                            Padding="12,8"
                            Background="{Binding IsPreviewVisible, Converter={StaticResource BoolToBrushConverter}}">
                        <StackPanel Orientation="Horizontal" Spacing="6">
                            <PathIcon Data="M12 4.5C7 4.5 2.73 7.61 1 12C2.73 16.39 7 19.5 12 19.5S21.27 16.39 23 12C21.27 7.61 17 4.5 12 4.5ZM12 17C9.24 17 7 14.76 7 12S9.24 7 12 7 17 9.24 17 12 14.76 17 12 17ZM12 9C10.34 9 9 10.34 9 12S10.34 15 12 15 15 13.66 15 12 13.66 9 12 9Z"
                                      Width="16" Height="16"/>
                            <TextBlock Text="Preview" VerticalAlignment="Center"/>
                        </StackPanel>
                    </Button>
                </StackPanel>
            </Grid>
        </Border>

        <!-- Main Content -->
        <Grid Grid.Row="1" ColumnDefinitions="280,*">

            <!-- Build List Sidebar -->
            <Border Grid.Column="0"
                    Background="{StaticResource GlassPanelTranslucentBrush}"
                    BorderBrush="{StaticResource GlassBorderBrush}"
                    BorderThickness="0,0,1,0"
                    Padding="12">
                <Grid RowDefinitions="Auto,Auto,*">
                    <TextBlock Grid.Row="0"
                               Text="Builds"
                               FontSize="18"
                               FontWeight="SemiBold"
                               Margin="0,0,0,12"/>

                    <!-- Search Box -->
                    <TextBox Grid.Row="1"
                             Text="{Binding SearchText}"
                             Watermark="Search builds..."
                             Margin="0,0,0,12"
                             CornerRadius="4"/>

                    <!-- Build List -->
                    <ListBox Grid.Row="2"
                             ItemsSource="{Binding Builds}"
                             SelectedItem="{Binding SelectedBuild}"
                             Background="Transparent"
                             BorderThickness="0">
                        <ListBox.ItemTemplate>
                            <DataTemplate DataType="m:BuildProject">
                                <Border Background="{StaticResource GlassPanelBrush}"
                                        BorderBrush="{StaticResource GlassBorderBrush}"
                                        BorderThickness="1"
                                        CornerRadius="6"
                                        Padding="12"
                                        Margin="0,0,0,8">
                                    <Grid RowDefinitions="Auto,Auto,Auto">
                                        <TextBlock Grid.Row="0"
                                                   Text="{Binding BuildNumber}"
                                                   FontWeight="SemiBold"
                                                   FontSize="14"
                                                   TextTrimming="CharacterEllipsis"/>
                                        <TextBlock Grid.Row="1"
                                                   Text="{Binding Device}"
                                                   Foreground="{StaticResource GlassSubtleTextBrush}"
                                                   FontSize="12"
                                                   Margin="0,4,0,0"/>
                                        <TextBlock Grid.Row="2"
                                                   Text="{Binding BuildDate, StringFormat={}{0:yyyy-MM-dd}}"
                                                   Foreground="{StaticResource GlassSubtleTextBrush}"
                                                   FontSize="11"
                                                   Margin="0,2,0,0"/>
                                    </Grid>
                                </Border>
                            </DataTemplate>
                        </ListBox.ItemTemplate>
                    </ListBox>
                </Grid>
            </Border>

            <!-- Editor Area -->
            <Grid Grid.Column="1">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="{Binding IsPreviewVisible, Converter={StaticResource BoolToGridLengthConverter}}"/>
                </Grid.ColumnDefinitions>

                <!-- Editor Tabs -->
                <Border Grid.Column="0" Padding="16">
                    <TabControl SelectedIndex="{Binding SelectedTabIndex}">

                        <!-- Build Info Tab -->
                        <TabItem Header="Build Info">
                            <ScrollViewer>
                                <StackPanel Spacing="16" Margin="0,16,0,0">
                                    <Border Background="{StaticResource GlassPanelBrush}"
                                            BorderBrush="{StaticResource GlassBorderBrush}"
                                            BorderThickness="1"
                                            CornerRadius="8"
                                            Padding="20">
                                        <Grid RowDefinitions="Auto,Auto,Auto,Auto,Auto,Auto,Auto,Auto"
                                              ColumnDefinitions="150,*,32,150,*">

                                            <TextBlock Grid.Row="0" Grid.Column="0" Text="Build Number" VerticalAlignment="Center" Foreground="{StaticResource GlassSubtleTextBrush}"/>
                                            <TextBox Grid.Row="0" Grid.Column="1" Text="{Binding SelectedBuild.BuildNumber}" Margin="0,0,0,12"/>

                                            <TextBlock Grid.Row="0" Grid.Column="3" Text="Build Date" VerticalAlignment="Center" Foreground="{StaticResource GlassSubtleTextBrush}"/>
                                            <CalendarDatePicker Grid.Row="0" Grid.Column="4" SelectedDate="{Binding SelectedBuild.BuildDate}" Margin="0,0,0,12"/>

                                            <TextBlock Grid.Row="1" Grid.Column="0" Text="Device" VerticalAlignment="Center" Foreground="{StaticResource GlassSubtleTextBrush}"/>
                                            <TextBox Grid.Row="1" Grid.Column="1" Text="{Binding SelectedBuild.Device}" Margin="0,0,0,12"/>

                                            <TextBlock Grid.Row="1" Grid.Column="3" Text="Build Type" VerticalAlignment="Center" Foreground="{StaticResource GlassSubtleTextBrush}"/>
                                            <ComboBox Grid.Row="1" Grid.Column="4" SelectedItem="{Binding SelectedBuild.BuildType}" Margin="0,0,0,12">
                                                <ComboBoxItem Content="user"/>
                                                <ComboBoxItem Content="userdebug"/>
                                                <ComboBoxItem Content="eng"/>
                                            </ComboBox>

                                            <TextBlock Grid.Row="2" Grid.Column="0" Text="Android Version" VerticalAlignment="Center" Foreground="{StaticResource GlassSubtleTextBrush}"/>
                                            <TextBox Grid.Row="2" Grid.Column="1" Text="{Binding SelectedBuild.AndroidVersion}" Margin="0,0,0,12"/>

                                            <TextBlock Grid.Row="2" Grid.Column="3" Text="Security Patch" VerticalAlignment="Center" Foreground="{StaticResource GlassSubtleTextBrush}"/>
                                            <TextBox Grid.Row="2" Grid.Column="4" Text="{Binding SelectedBuild.SecurityPatch}" Margin="0,0,0,12"/>

                                            <TextBlock Grid.Row="3" Grid.Column="0" Text="Kernel Version" VerticalAlignment="Center" Foreground="{StaticResource GlassSubtleTextBrush}"/>
                                            <TextBox Grid.Row="3" Grid.Column="1" Text="{Binding SelectedBuild.KernelVersion}" Margin="0,0,0,12"/>

                                            <TextBlock Grid.Row="3" Grid.Column="3" Text="Previous Build" VerticalAlignment="Center" Foreground="{StaticResource GlassSubtleTextBrush}"/>
                                            <TextBox Grid.Row="3" Grid.Column="4" Text="{Binding SelectedBuild.PreviousBuild}" Margin="0,0,0,12"/>
                                        </Grid>
                                    </Border>

                                    <!-- Files Section -->
                                    <Border Background="{StaticResource GlassPanelBrush}"
                                            BorderBrush="{StaticResource GlassBorderBrush}"
                                            BorderThickness="1"
                                            CornerRadius="8"
                                            Padding="20">
                                        <StackPanel>
                                            <Grid ColumnDefinitions="*,Auto,Auto">
                                                <TextBlock Grid.Column="0" Text="Files" FontSize="16" FontWeight="SemiBold" Margin="0,0,0,12"/>
                                                <Button Grid.Column="1" Command="{Binding ComputeChecksumsCommand}" Content="Compute SHA256" Margin="0,0,8,12" Padding="12,6"/>
                                                <Button Grid.Column="2" Command="{Binding AddFileCommand}" Content="+ Add File" Margin="0,0,0,12" Padding="12,6"/>
                                            </Grid>
                                            <DataGrid ItemsSource="{Binding SelectedBuild.Files}"
                                                      AutoGenerateColumns="False"
                                                      CanUserReorderColumns="False"
                                                      CanUserResizeColumns="True"
                                                      GridLinesVisibility="Horizontal"
                                                      BorderThickness="1"
                                                      BorderBrush="{StaticResource GlassBorderBrush}"
                                                      CornerRadius="4">
                                                <DataGrid.Columns>
                                                    <DataGridTextColumn Header="File Name" Binding="{Binding FileName}" Width="*"/>
                                                    <DataGridTextColumn Header="Size" Binding="{Binding FileSize}" Width="100"/>
                                                    <DataGridTextColumn Header="SHA256" Binding="{Binding Sha256}" Width="200"/>
                                                    <DataGridTemplateColumn Header="" Width="40">
                                                        <DataGridTemplateColumn.CellTemplate>
                                                            <DataTemplate>
                                                                <Button Command="{Binding $parent[DataGrid].((vm:MainWindowViewModel)DataContext).RemoveFileCommand}"
                                                                        CommandParameter="{Binding}"
                                                                        Content="X"
                                                                        Padding="4"
                                                                        Background="Transparent"
                                                                        Foreground="{StaticResource GlassErrorColor}"/>
                                                            </DataTemplate>
                                                        </DataGridTemplateColumn.CellTemplate>
                                                    </DataGridTemplateColumn>
                                                </DataGrid.Columns>
                                            </DataGrid>
                                        </StackPanel>
                                    </Border>
                                </StackPanel>
                            </ScrollViewer>
                        </TabItem>

                        <!-- Changelog Tab -->
                        <TabItem Header="Changelog">
                            <ScrollViewer>
                                <StackPanel Spacing="16" Margin="0,16,0,0">
                                    <!-- App Updates -->
                                    <Border Background="{StaticResource GlassPanelBrush}"
                                            BorderBrush="{StaticResource GlassBorderBrush}"
                                            BorderThickness="1"
                                            CornerRadius="8"
                                            Padding="20">
                                        <StackPanel>
                                            <Grid ColumnDefinitions="*,Auto">
                                                <TextBlock Grid.Column="0" Text="App Updates" FontSize="16" FontWeight="SemiBold" Margin="0,0,0,12"/>
                                                <Button Grid.Column="1" Command="{Binding AddAppUpdateCommand}" Content="+ Add App" Margin="0,0,0,12" Padding="12,6"/>
                                            </Grid>
                                            <DataGrid ItemsSource="{Binding SelectedBuild.AppUpdates}"
                                                      AutoGenerateColumns="False"
                                                      CanUserReorderColumns="False"
                                                      CanUserResizeColumns="True"
                                                      GridLinesVisibility="Horizontal"
                                                      BorderThickness="1"
                                                      BorderBrush="{StaticResource GlassBorderBrush}"
                                                      CornerRadius="4"
                                                      MaxHeight="250">
                                                <DataGrid.Columns>
                                                    <DataGridTextColumn Header="App Name" Binding="{Binding AppName}" Width="150"/>
                                                    <DataGridTextColumn Header="Path" Binding="{Binding Path}" Width="*"/>
                                                    <DataGridTextColumn Header="Version" Binding="{Binding Version}" Width="80"/>
                                                    <DataGridTextColumn Header="Changes" Binding="{Binding Changes}" Width="*"/>
                                                    <DataGridTemplateColumn Header="" Width="40">
                                                        <DataGridTemplateColumn.CellTemplate>
                                                            <DataTemplate>
                                                                <Button Command="{Binding $parent[DataGrid].((vm:MainWindowViewModel)DataContext).RemoveAppUpdateCommand}"
                                                                        CommandParameter="{Binding}"
                                                                        Content="X"
                                                                        Padding="4"
                                                                        Background="Transparent"
                                                                        Foreground="{StaticResource GlassErrorColor}"/>
                                                            </DataTemplate>
                                                        </DataGridTemplateColumn.CellTemplate>
                                                    </DataGridTemplateColumn>
                                                </DataGrid.Columns>
                                            </DataGrid>
                                        </StackPanel>
                                    </Border>

                                    <!-- System Modifications -->
                                    <Border Background="{StaticResource GlassPanelBrush}"
                                            BorderBrush="{StaticResource GlassBorderBrush}"
                                            BorderThickness="1"
                                            CornerRadius="8"
                                            Padding="20">
                                        <StackPanel>
                                            <TextBlock Text="System Modifications" FontSize="16" FontWeight="SemiBold" Margin="0,0,0,8"/>
                                            <TextBlock Text="Enter each modification on a new line" FontSize="12" Foreground="{StaticResource GlassSubtleTextBrush}" Margin="0,0,0,8"/>
                                            <TextBox Text="{Binding SelectedBuild.SystemModifications}"
                                                     AcceptsReturn="True"
                                                     TextWrapping="Wrap"
                                                     Height="100"/>
                                        </StackPanel>
                                    </Border>

                                    <!-- Kernel/Driver Changes -->
                                    <Border Background="{StaticResource GlassPanelBrush}"
                                            BorderBrush="{StaticResource GlassBorderBrush}"
                                            BorderThickness="1"
                                            CornerRadius="8"
                                            Padding="20">
                                        <StackPanel>
                                            <TextBlock Text="Kernel/Driver Changes" FontSize="16" FontWeight="SemiBold" Margin="0,0,0,8"/>
                                            <TextBox Text="{Binding SelectedBuild.KernelDriverChanges}"
                                                     AcceptsReturn="True"
                                                     TextWrapping="Wrap"
                                                     Height="100"/>
                                        </StackPanel>
                                    </Border>

                                    <!-- Configuration Changes -->
                                    <Border Background="{StaticResource GlassPanelBrush}"
                                            BorderBrush="{StaticResource GlassBorderBrush}"
                                            BorderThickness="1"
                                            CornerRadius="8"
                                            Padding="20">
                                        <StackPanel>
                                            <TextBlock Text="Configuration Changes" FontSize="16" FontWeight="SemiBold" Margin="0,0,0,8"/>
                                            <TextBox Text="{Binding SelectedBuild.ConfigurationChanges}"
                                                     AcceptsReturn="True"
                                                     TextWrapping="Wrap"
                                                     Height="100"/>
                                        </StackPanel>
                                    </Border>

                                    <!-- Removed Components -->
                                    <Border Background="{StaticResource GlassPanelBrush}"
                                            BorderBrush="{StaticResource GlassBorderBrush}"
                                            BorderThickness="1"
                                            CornerRadius="8"
                                            Padding="20">
                                        <StackPanel>
                                            <TextBlock Text="Removed Components" FontSize="16" FontWeight="SemiBold" Margin="0,0,0,8"/>
                                            <TextBox Text="{Binding SelectedBuild.RemovedComponents}"
                                                     AcceptsReturn="True"
                                                     TextWrapping="Wrap"
                                                     Height="100"/>
                                        </StackPanel>
                                    </Border>
                                </StackPanel>
                            </ScrollViewer>
                        </TabItem>

                        <!-- Known Issues Tab -->
                        <TabItem Header="Issues">
                            <ScrollViewer>
                                <Border Background="{StaticResource GlassPanelBrush}"
                                        BorderBrush="{StaticResource GlassBorderBrush}"
                                        BorderThickness="1"
                                        CornerRadius="8"
                                        Padding="20"
                                        Margin="0,16,0,0">
                                    <StackPanel>
                                        <Grid ColumnDefinitions="*,Auto">
                                            <TextBlock Grid.Column="0" Text="Known Issues" FontSize="16" FontWeight="SemiBold" Margin="0,0,0,12"/>
                                            <Button Grid.Column="1" Command="{Binding AddKnownIssueCommand}" Content="+ Add Issue" Margin="0,0,0,12" Padding="12,6"/>
                                        </Grid>
                                        <DataGrid ItemsSource="{Binding SelectedBuild.KnownIssues}"
                                                  AutoGenerateColumns="False"
                                                  CanUserReorderColumns="False"
                                                  CanUserResizeColumns="True"
                                                  GridLinesVisibility="Horizontal"
                                                  BorderThickness="1"
                                                  BorderBrush="{StaticResource GlassBorderBrush}"
                                                  CornerRadius="4">
                                            <DataGrid.Columns>
                                                <DataGridTextColumn Header="Issue" Binding="{Binding Issue}" Width="*"/>
                                                <DataGridTemplateColumn Header="Severity" Width="100">
                                                    <DataGridTemplateColumn.CellTemplate>
                                                        <DataTemplate>
                                                            <ComboBox SelectedItem="{Binding Severity}" ItemsSource="{x:Static m:KnownIssue.SeverityOptions}"/>
                                                        </DataTemplate>
                                                    </DataGridTemplateColumn.CellTemplate>
                                                </DataGridTemplateColumn>
                                                <DataGridTemplateColumn Header="Status" Width="100">
                                                    <DataGridTemplateColumn.CellTemplate>
                                                        <DataTemplate>
                                                            <ComboBox SelectedItem="{Binding Status}" ItemsSource="{x:Static m:KnownIssue.StatusOptions}"/>
                                                        </DataTemplate>
                                                    </DataGridTemplateColumn.CellTemplate>
                                                </DataGridTemplateColumn>
                                                <DataGridTextColumn Header="Workaround" Binding="{Binding Workaround}" Width="*"/>
                                                <DataGridTemplateColumn Header="" Width="40">
                                                    <DataGridTemplateColumn.CellTemplate>
                                                        <DataTemplate>
                                                            <Button Command="{Binding $parent[DataGrid].((vm:MainWindowViewModel)DataContext).RemoveKnownIssueCommand}"
                                                                    CommandParameter="{Binding}"
                                                                    Content="X"
                                                                    Padding="4"
                                                                    Background="Transparent"
                                                                    Foreground="{StaticResource GlassErrorColor}"/>
                                                        </DataTemplate>
                                                    </DataGridTemplateColumn.CellTemplate>
                                                </DataGridTemplateColumn>
                                            </DataGrid.Columns>
                                        </DataGrid>
                                    </StackPanel>
                                </Border>
                            </ScrollViewer>
                        </TabItem>

                        <!-- Testing Tab -->
                        <TabItem Header="Testing">
                            <ScrollViewer>
                                <Border Background="{StaticResource GlassPanelBrush}"
                                        BorderBrush="{StaticResource GlassBorderBrush}"
                                        BorderThickness="1"
                                        CornerRadius="8"
                                        Padding="20"
                                        Margin="0,16,0,0">
                                    <StackPanel>
                                        <Grid ColumnDefinitions="*,Auto">
                                            <TextBlock Grid.Column="0" Text="Testing Status" FontSize="16" FontWeight="SemiBold" Margin="0,0,0,12"/>
                                            <Button Grid.Column="1" Command="{Binding AddTestResultCommand}" Content="+ Add Test" Margin="0,0,0,12" Padding="12,6"/>
                                        </Grid>
                                        <DataGrid ItemsSource="{Binding SelectedBuild.TestResults}"
                                                  AutoGenerateColumns="False"
                                                  CanUserReorderColumns="False"
                                                  CanUserResizeColumns="True"
                                                  GridLinesVisibility="Horizontal"
                                                  BorderThickness="1"
                                                  BorderBrush="{StaticResource GlassBorderBrush}"
                                                  CornerRadius="4">
                                            <DataGrid.Columns>
                                                <DataGridTextColumn Header="Test Name" Binding="{Binding TestName}" Width="*"/>
                                                <DataGridTemplateColumn Header="Result" Width="120">
                                                    <DataGridTemplateColumn.CellTemplate>
                                                        <DataTemplate>
                                                            <ComboBox SelectedItem="{Binding Result}" ItemsSource="{x:Static m:TestResult.ResultOptions}"/>
                                                        </DataTemplate>
                                                    </DataGridTemplateColumn.CellTemplate>
                                                </DataGridTemplateColumn>
                                                <DataGridTextColumn Header="Notes" Binding="{Binding Notes}" Width="*"/>
                                                <DataGridTemplateColumn Header="" Width="40">
                                                    <DataGridTemplateColumn.CellTemplate>
                                                        <DataTemplate>
                                                            <Button Command="{Binding $parent[DataGrid].((vm:MainWindowViewModel)DataContext).RemoveTestResultCommand}"
                                                                    CommandParameter="{Binding}"
                                                                    Content="X"
                                                                    Padding="4"
                                                                    Background="Transparent"
                                                                    Foreground="{StaticResource GlassErrorColor}"/>
                                                        </DataTemplate>
                                                    </DataGridTemplateColumn.CellTemplate>
                                                </DataGridTemplateColumn>
                                            </DataGrid.Columns>
                                        </DataGrid>
                                    </StackPanel>
                                </Border>
                            </ScrollViewer>
                        </TabItem>

                        <!-- Release Tab -->
                        <TabItem Header="Release">
                            <ScrollViewer>
                                <StackPanel Spacing="16" Margin="0,16,0,0">
                                    <!-- Dependencies -->
                                    <Border Background="{StaticResource GlassPanelBrush}"
                                            BorderBrush="{StaticResource GlassBorderBrush}"
                                            BorderThickness="1"
                                            CornerRadius="8"
                                            Padding="20">
                                        <StackPanel>
                                            <TextBlock Text="Dependencies" FontSize="16" FontWeight="SemiBold" Margin="0,0,0,12"/>
                                            <Grid RowDefinitions="Auto,Auto" ColumnDefinitions="150,*">
                                                <TextBlock Grid.Row="0" Grid.Column="0" Text="Bootloader Version" VerticalAlignment="Center" Foreground="{StaticResource GlassSubtleTextBrush}"/>
                                                <TextBox Grid.Row="0" Grid.Column="1" Text="{Binding SelectedBuild.BootloaderVersion}" Margin="0,0,0,12"/>

                                                <TextBlock Grid.Row="1" Grid.Column="0" Text="Compatible OTA" VerticalAlignment="Center" Foreground="{StaticResource GlassSubtleTextBrush}"/>
                                                <TextBox Grid.Row="1" Grid.Column="1" Text="{Binding SelectedBuild.CompatibleOtaBuilds}"/>
                                            </Grid>
                                        </StackPanel>
                                    </Border>

                                    <!-- Recommended For -->
                                    <Border Background="{StaticResource GlassPanelBrush}"
                                            BorderBrush="{StaticResource GlassBorderBrush}"
                                            BorderThickness="1"
                                            CornerRadius="8"
                                            Padding="20">
                                        <StackPanel>
                                            <TextBlock Text="Recommended For" FontSize="16" FontWeight="SemiBold" Margin="0,0,0,12"/>
                                            <CheckBox Content="Internal Testing" IsChecked="{Binding SelectedBuild.InternalTesting}" Margin="0,0,0,8"/>
                                            <CheckBox Content="Customer Release" IsChecked="{Binding SelectedBuild.CustomerRelease}" Margin="0,0,0,12"/>
                                            <Grid ColumnDefinitions="150,*">
                                                <TextBlock Grid.Column="0" Text="Specific Customer" VerticalAlignment="Center" Foreground="{StaticResource GlassSubtleTextBrush}"/>
                                                <TextBox Grid.Column="1" Text="{Binding SelectedBuild.SpecificCustomer}"/>
                                            </Grid>
                                        </StackPanel>
                                    </Border>

                                    <!-- Customer Release Notes -->
                                    <Border Background="{StaticResource GlassPanelBrush}"
                                            BorderBrush="{StaticResource GlassBorderBrush}"
                                            BorderThickness="1"
                                            CornerRadius="8"
                                            Padding="20">
                                        <StackPanel>
                                            <TextBlock Text="Customer Release Notes" FontSize="16" FontWeight="SemiBold" Margin="0,0,0,8"/>
                                            <TextBox Text="{Binding SelectedBuild.CustomerReleaseNotes}"
                                                     AcceptsReturn="True"
                                                     TextWrapping="Wrap"
                                                     Height="150"/>
                                        </StackPanel>
                                    </Border>

                                    <!-- Build Engineer -->
                                    <Border Background="{StaticResource GlassPanelBrush}"
                                            BorderBrush="{StaticResource GlassBorderBrush}"
                                            BorderThickness="1"
                                            CornerRadius="8"
                                            Padding="20">
                                        <StackPanel>
                                            <TextBlock Text="Build Engineer" FontSize="16" FontWeight="SemiBold" Margin="0,0,0,12"/>
                                            <Grid RowDefinitions="Auto,Auto,Auto" ColumnDefinitions="150,*">
                                                <TextBlock Grid.Row="0" Grid.Column="0" Text="Built by" VerticalAlignment="Center" Foreground="{StaticResource GlassSubtleTextBrush}"/>
                                                <TextBox Grid.Row="0" Grid.Column="1" Text="{Binding SelectedBuild.BuiltBy}" Margin="0,0,0,12"/>

                                                <TextBlock Grid.Row="1" Grid.Column="0" Text="Reviewed by" VerticalAlignment="Center" Foreground="{StaticResource GlassSubtleTextBrush}"/>
                                                <TextBox Grid.Row="1" Grid.Column="1" Text="{Binding SelectedBuild.ReviewedBy}" Margin="0,0,0,12"/>

                                                <TextBlock Grid.Row="2" Grid.Column="0" Text="Approved Date" VerticalAlignment="Center" Foreground="{StaticResource GlassSubtleTextBrush}"/>
                                                <CalendarDatePicker Grid.Row="2" Grid.Column="1" SelectedDate="{Binding SelectedBuild.ApprovedForReleaseDate}"/>
                                            </Grid>
                                        </StackPanel>
                                    </Border>
                                </StackPanel>
                            </ScrollViewer>
                        </TabItem>
                    </TabControl>
                </Border>

                <!-- Preview Panel -->
                <Border Grid.Column="1"
                        IsVisible="{Binding IsPreviewVisible}"
                        Background="{StaticResource GlassPanelBrush}"
                        BorderBrush="{StaticResource GlassBorderBrush}"
                        BorderThickness="1,0,0,0">
                    <Grid RowDefinitions="Auto,*">
                        <Border Grid.Row="0"
                                Background="{StaticResource GlassBackgroundBrush}"
                                Padding="16,12">
                            <Grid ColumnDefinitions="*,Auto">
                                <TextBlock Grid.Column="0" Text="Markdown Preview" FontWeight="SemiBold"/>
                                <Button Grid.Column="1" Command="{Binding UpdatePreviewCommand}" Content="Refresh" Padding="8,4"/>
                            </Grid>
                        </Border>
                        <ScrollViewer Grid.Row="1" Padding="16">
                            <TextBox Text="{Binding PreviewContent}"
                                     IsReadOnly="True"
                                     AcceptsReturn="True"
                                     TextWrapping="Wrap"
                                     FontFamily="Consolas,Monaco,monospace"
                                     FontSize="12"
                                     Background="Transparent"
                                     BorderThickness="0"/>
                        </ScrollViewer>
                    </Grid>
                </Border>
            </Grid>
        </Grid>

        <!-- Status Bar -->
        <Border Grid.Row="2"
                Background="{StaticResource GlassPanelTranslucentBrush}"
                BorderBrush="{StaticResource GlassBorderBrush}"
                BorderThickness="0,1,0,0"
                Padding="16,8">
            <Grid ColumnDefinitions="Auto,*,Auto">
                <ProgressBar Grid.Column="0"
                             IsIndeterminate="{Binding IsBusy}"
                             IsVisible="{Binding IsBusy}"
                             Width="100"
                             Margin="0,0,16,0"/>
                <TextBlock Grid.Column="1"
                           Text="{Binding StatusMessage}"
                           VerticalAlignment="Center"/>
                <TextBlock Grid.Column="2"
                           Text="{Binding SelectedBuild.LastUpdated, StringFormat='Last updated: {0:yyyy-MM-dd HH:mm}'}"
                           Foreground="{StaticResource GlassSubtleTextBrush}"
                           VerticalAlignment="Center"/>
            </Grid>
        </Border>
    </Grid>
</Window>
